{% from "sort_filter.html" import sort_filter%}
{% macro league_dropdown(val="",ini="") %}
{# TODO DO NOT EDIT #}
<select title="drop" class="form-select mb-3" name="name" value="{{ini or ''}}">
{% if val=='league'%}
{% set options = get_leagues()%}
{%else%}
{% set options = get_teams()%}
{%endif%}
<option value="">No {{val}}</option>
{% for c in options %}
<option {{'selected' if ini|string==c['id']|string}} value="{{c['id']}}">{{c['name']}}</option>
{% endfor %}
</select>
{% endmacro %}

{% extends "layout.html" %}

{% block title %}Watchlist{% endblock %}
{% block content %}
<nav style="
background-image: url('https://i0.wp.com/ordinaryfaith.net/wp-content/uploads/2016/03/Gray-plain-website-background.jpg?fit=1920%2C1080&ssl=1');
min-height: 100%;
background-repeat: no-repeat;
background-attachment: fixed;
background-position: center;
background-size: cover;">
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
      <a class="nav-link active" id="nav-league-tab" data-bs-toggle="tab" href="#nav-league" role="tab" aria-controls="nav-league" aria-selected="true">Leagues</a>
      <a class="nav-link" id="nav-team-tab" data-bs-toggle="tab" href="#nav-team" role="tab" aria-controls="nav-team" aria-selected="false">Teams</a>
    </div>
  </nav>

<!-- Tab panes -->
<div class="tab-content" id="nav-tabContent" style="
background-image: url('https://i0.wp.com/ordinaryfaith.net/wp-content/uploads/2016/03/Gray-plain-website-background.jpg?fit=1920%2C1080&ssl=1');
height: 100vh;">
  <div class="tab-pane fade {{'show active' if not apply_where}}" id="nav-league" role="tabpanel" aria-labelledby="nav-league-tab" >
    {% if league_list and league_list|length > 0 %}
    <div class="container-fluid">
    <!--form controls-->
    <form method="GET"> 
        <div class="row">
            <div class="col-12" style="max-width: 10%;">
                <label class="form-label visually-hidden" for="league_name">League Name</label>
                <input type="text" name="league_name" class="form-control" id="fn" placeholder="League Name"
                    value="{{request.args.get('league_name') or ''}}">
                </div>
                <div class="col-12" style="max-width: 10%;">
                    <label class="form-label visually-hidden" for="country_name">Country</label>
                    <input type="text" name="country_name" class="form-control" id="ln" placeholder="Country"
                        value="{{request.args.get('country_name') or ''}}">
                </div>
                <input type="hidden" id="postId" name="apply_where" value='' />

                <div class="col">
                    <input type="submit" class="btn btn-primary" value="Filter" />
                </div>
                </div>
    </form>
 
    <!--Leagues-->

    <div class="container">
        <div class="row">
        <div class="col-12">
            <table style="color: white;" class="table table-borderless">
                <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col">Name</th>
                    <th scope="col">Country</th>
                </tr>
                </thead>
                <tbody>
                {% for c in league_list%}
                <tr>
                    <td class="w-25">
                        <img src = "{{c['logo']}}" alt="{{c['name']+' logo'}}">
                    </td>
                    <td>{{c['name']}}</td>
                    <td>{{c['country']}}</td>
                    <td><form method="GET"><input type="submit" name="submit_button" class="btn btn-primary" value="remove" formaction="../watchlist/delete" />
                        <input type="hidden" id="postId" name="id" value="{{c['id']}}" />
                        <input type="hidden" id="postId" name="type" value="league" /></form></td>
                    <td><form method="GET"><input type="submit" name="submit_button" class="btn btn-primary" value="edit" formaction="../watchlist/edit" />
                        <input type="hidden" id="postId" name="id" value="{{c['id']}}" />
                        <input type="hidden" id="postId" name="type" value="league" /></form></td>
                        <td><a href="{{url_for('watchlist.getstandings',name=c['id'])}}">Standings</a></td>
                        <td><a href="{{url_for('watchlist.getfixtures',name=c['id'])}}">Fixtues and live results</a></td>
                        <td></td>

                </tr>
                {% endfor %}
                </tbody>
            </table>   
        </div>
        </div>
    </div>


  
   
    </div>
    {%else%}
<h1>No leagues in Watchlist Yet</h1>
    {%endif%}
  </div>
  <div class="tab-pane fade {{'show active' if apply_where}}" id="nav-team" role="tabpanel" aria-labelledby="nav-team-tab">
    {% if team_list and team_list|length > 0 %}
    <div class="container-fluid">
    <form method="GET"> 
        
        <div class="row">
            <div class="col-12" style="max-width: 10%;">
                <label class="form-label visually-hidden" for="teamn_name">Team Name</label>
                <input type="text" name="team_name" class="form-control" id="fn" placeholder="Team Name"
                    value="{{request.args.get('team_name') or ''}}">
                </div>

                <div class="col-12" style="max-width: 10%;">
                    <label class="form-label visually-hidden" for="country_name">Country</label>
                    <input type="text" name="country_name" class="form-control" id="ln" placeholder="Country"
                        value="{{request.args.get('country_name') or ''}}">
                </div>

                <div class="col">
                    <label class="visually-hidden" for="leagues">League</label>
                    {{league_dropdown(val='league',ini=request.args.get("name"))}}
                </div>

                {{sort_filter(cols=allowed_columns)}}
                <div class="col-12" style="max-width: 10%;">
                    <label class="form-label visually-hidden" for="limit">Limit</label>
                    <input type="number" name="limit" class="form-control" id="limit" placeholder="Limit" min="0" max="100"
                        value="{{request.args.get('limit') or 10}}">
                </div>

                <div class="col">
                    <input type="submit" class="btn btn-primary" value="Filter" />
                </div>
                </div>
                <input type="hidden" id="postId" name="apply_where" value="team" />
    </form>



         <!--Teams-->

       <div class="container">
        <div class="row">
        <div class="col-12">
            <table style="color: white;" class="table table-borderless">
                <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col">Name</th>
                    <th scope="col">Country</th>
                </tr>
                </thead>
                <tbody>
                {% for c in team_list%}
                <tr>
                    <td class="w-25">
                        <img src = "{{c['logo']}}" alt="{{c['name']+' logo'}}">
                    </td>
                    <td>{{c['name']}}</td>
                    <td>{{c['country']}}</td>
                    <td><form method="GET"><input type="submit" name="submit_button" class="btn btn-primary" value="remove" formaction="../watchlist/delete" />
                        <input type="hidden" id="postId" name="id" value="{{c['id']}}" />
                        <input type="hidden" id="postId" name="type" value="team" />
                        <input type="hidden" id="postId" name="team_name" value="{{request.args.get('team_name') or ''}}" />
                        <input type="hidden" id="postId" name="country_name" value="{{request.args.get('country_name') or ''}}" />
                    </form></td>
                    <td><form method="GET"><input type="submit" name="submit_button" class="btn btn-primary" value="edit" formaction="../watchlist/edit" />
                        <input type="hidden" id="postId" name="id" value="{{c['id']}}" />
                        <input type="hidden" id="postId" name="type" value="team" /></form></td>
                        <td><form method="GET"><input type="submit" name="submit_button" class="btn btn-primary" value="view stats" formaction="{{url_for('watchlist.viewstatistics')}}" />
                            <input type="hidden" id="postId" name="id" value="{{c['id']}}" />
                            <input type="hidden" id="postId" name="league_id" value="{{c['league_id']}}"/>
                            <input type="hidden" id="postId" name="type" value="team" /></form></td>
                </tr>
                {% endfor %}
                </tbody>
            </table>   
        </div>
        </div>
    </div>

    </div>
{%else%}
<h1>No Teams in Watchlist Yet</h1>
{%endif%}

  </div>
</div>



{% endblock %}




